# VietnamVisa24 기능 명세서

### **문서 개요**

본 문서는 'vietnamvisa24' 프로젝트의 주요 기능들을 정의하고, 각 기능의 요구사항, 동작 방식, 클라이언트-서버 간 연동 규격을 명세합니다. AI 코딩 에이전트가 이 명세서를 기반으로 개발, 수정, 유지보수 작업을 수행하는 것을 목표로 합니다.

**프로젝트 구조:**
* **클라이언트 (`/client`):** Next.js 기반 프론트엔드. 사용자 페이지와 관리자 대시보드로 구성됩니다.
* **서버 (`/server`):** Node.js, Apollo Server (GraphQL), Sequelize (ORM) 기반 백엔드.

---

### **1. 사용자 (고객) 페이지**

고객이 서비스를 탐색하고, 비자를 신청하며, 관련 정보를 얻는 공개 페이지 영역입니다.

| 메뉴/페이지 (경로) | 주요 기능 | 세부 기능 및 로직 | 클라이언트-서버 연동 (API & CRUD) | 개선 사항 |
| :--- | :--- | :--- | :--- | :--- |
| **홈 (`/`)** | 서비스 소개 및 메인 랜딩 | - 제공하는 비자 서비스(E-Visa, 공항 패스트트랙 등) 개요 노출<br>- 서비스 절차, 고객 후기, FAQ 섹션 제공<br>- 주요 서비스 신청 페이지로 연결되는 CTA 버튼 배치 | **[R]** `getServices`, `getFaqs`: 정적 콘텐츠 또는 DB에서 서비스 목록 및 FAQ 데이터를 조회하여 렌더링. (현재는 하드코딩된 것으로 보이며, DB 연동 필요) | - **동적 콘텐츠 관리:** 관리자 대시보드에서 홈 페이지의 서비스 소개, FAQ 등을 직접 수정할 수 있는 기능 추가. |
| **E-Visa 안내 (`/e-visa`)** | E-Visa 서비스 상세 안내 및 가격 정보 제공 | - E-Visa의 특징, 장점, 필요 서류 등 상세 정보 제공<br>- 국적, 입국 공항, 비자 종류에 따른 가격표 조회 | **[R]** `getEVisaPrices`: 국적, 처리 기간(일반/긴급)별 E-Visa 가격 정보를 조회하여 동적으로 테이블 생성. | - **가격 계산기:** 사용자가 국적, 인원수, 처리 속도를 선택하면 예상 비용을 바로 계산해주는 실시간 계산기 UI 추가. |
| **비자 신청 (`/apply`)** | 비자 신청서 작성 및 제출 | - **Step-based Form:**<br>  1. 비자 유형, 국적, 입국일 등 기본 정보 선택<br>  2. 여권 정보, 개인 인적 사항 입력<br>  3. 여권 사본, 증명사진 등 필요 서류 업로드<br>  4. 입력 정보 최종 확인 및 결제 진행<br>- 신청 완료 시 사용자에게 확인 이메일 발송 | **[C]** `createVisaApplication(input)`: 사용자가 입력한 모든 정보(텍스트, 파일)를 서버로 전송하여 `VisaApplication` 및 `Document` 테이블에 새로운 레코드 생성. 파일은 S3 등 스토리지에 업로드 후 URL을 DB에 저장.<br>**[R]** `getServicePrice(type, options)`: 사용자가 선택한 옵션에 맞는 가격을 실시간으로 조회. | - **임시 저장:** 사용자가 긴 양식을 작성하다 이탈해도 내용이 유지되도록 `localStorage`를 활용한 임시 저장 기능 추가.<br>- **입력값 검증 강화:** 각 입력 필드에 대한 실시간 유효성 검사 로직(정규식, 글자 수 제한 등) 고도화.<br>- **주소 검색 API 연동:** 주소 입력 편의성을 위해 주소 검색 API(예: Google Places) 연동. |
| **사용자 로그인/가입 (`/login`, `/register`)** | 고객 계정 관리 | - 이메일/비밀번호 기반의 가입 및 로그인 기능<br>- 소셜 로그인(Google, Kakao) 옵션 제공<br>- 로그인 시 본인의 신청 내역을 확인할 수 있는 페이지로 리디렉션 | **[C]** `registerUser(input)`: 사용자 가입 처리.<br>**[C]** `login(email, password)`: 로그인 인증 처리. JWT(JSON Web Token)를 발급하여 클라이언트 측에 저장.<br>**[R]** `getMyProfile`: 로그인된 사용자의 정보를 가져옴. | - **내 신청 내역 페이지:** 사용자가 로그인 후 자신의 비자 신청 목록과 현재 진행 상태(예: '서류 검토 중', '발급 완료')를 직접 확인할 수 있는 'My Page' 구현. |
| **기타 서비스 페이지** | 부가 서비스 안내 | `/airport-fast-track`<br>`/airport-pickup`<br>`/mobile-visa-run` 등 각 서비스에 대한 상세 설명 및 신청/문의 기능 제공. | 각 서비스에 맞는 신청/문의 폼과 그에 따른 API 연동 필요. (예: `createFastTrackRequest`) | - **통합 신청:** 여러 서비스를 한번에 신청하고 결제할 수 있는 장바구니 기능 도입 고려. |

---

### **2. 관리자 대시보드 (`/dashboard`)**

관리자가 비자 신청, 고객, 결제 등 모든 데이터를 관리하고 운영하는 내부 시스템입니다.

| 메뉴 (경로) | 하위 메뉴 | 주요 기능 | 클라이언트-서버 연동 (API & CRUD) | 개선 사항 |
| :--- | :--- | :--- | :--- | :--- |
| **대시보드 (`/`)** | - | **핵심 지표 시각화 (KPI)**<br>- 신규 신청 건수, 총매출, 처리 대기 건수 등 주요 현황 요약<br>- 최근 활동 로그 (신규 신청, 고객 문의 등)<br>- 상태별 신청 현황 차트 | **[R]** `getDashboardStats`: 대시보드에 필요한 모든 통계 데이터를 한 번의 요청으로 조회. (신청 수, 매출, 상태별 카운트 등) | - **기간별 필터링:** 일간, 주간, 월간 단위로 통계 데이터를 필터링하여 조회하는 기능 추가.<br>- **차트 고도화:** 매출 추이, 국적별 신청 분포 등 비즈니스 분석에 유용한 시각적 차트 추가. |
| **신청 관리 (`/applications`)** | - 목록<br>- 상세 | **모든 비자 신청 건 관리**<br>- 신청 목록 조회 (검색, 필터링, 정렬 기능 포함)<br>- 개별 신청 건의 상세 정보 확인 (고객 정보, 서류, 결제 내역)<br>- 신청 상태 변경 (예: 접수 -> 심사 중 -> 완료)<br>- 관리자 메모 추가 | **[C]** `createApplicationByAdmin`: 관리자가 수동으로 신청 건 생성.<br>**[R]** `getVisaApplications(filter, sort, pagination)`: 조건에 맞는 신청 목록 조회.<br>**[R]** `getVisaApplication(id)`: 특정 신청 건 상세 정보 조회.<br>**[U]** `updateVisaApplication(id, input)`: 신청 정보 수정.<br>**[U]** `updateApplicationStatus(id, status, note)`: 신청 상태 및 메모 업데이트. `ApplicationStatusHistory`에 로그 기록.<br>**[D]** `deleteVisaApplication(id)`: 신청 건 삭제. | - **벌크 작업:** 여러 신청 건을 선택하여 상태를 한 번에 변경하는 기능 추가.<br>- **History 탭:** 상세 페이지 내에서 해당 신청 건의 상태 변경 이력을 시간순으로 명확하게 보여주는 UI 추가. |
| **고객 관리 (`/users`)** | - 목록<br>- 상세 | **가입된 모든 사용자 관리**<br>- 사용자 목록 조회 및 검색<br>- 사용자 상세 정보 확인<br>- 특정 사용자의 모든 신청 내역, 문의 내역 조회 | **[R]** `getUsers`: 전체 사용자 목록 조회.<br>**[R]** `getUser(id)`: 특정 사용자 상세 정보 및 관련 데이터(신청, 문의 등) 조회.<br>**[U]** `updateUser(id, input)`: 사용자 정보 수정.<br>**[D]** `deleteUser(id)`: 사용자 계정 삭제. | - **권한 관리:** '관리자', '상담원' 등 세분화된 역할(Role)을 정의하고 메뉴 접근 권한을 차등 부여하는 기능 추가. |
| **서비스/가격 관리 (`/pricing`)** | - E-Visa<br>- Fast-Track | **판매 서비스의 가격 정책 관리**<br>- 비자 종류, 국적, 처리 속도별 가격 설정<br>- 부가 서비스(패스트트랙 등) 가격 설정<br>- 기존 가격 수정 및 신규 가격 정책 추가 | **[C]** `createPrice(serviceType, input)`: 새로운 가격 항목 추가.<br>**[R]** `getPrices(serviceType)`: 서비스 종류별 전체 가격표 조회.<br>**[U]** `updatePrice(id, input)`: 기존 가격 정보 수정.<br>**[D]** `deletePrice(id)`: 가격 항목 삭제. | - **프로모션 기능:** 특정 기간 동안 할인이 적용되는 프로모션 코드를 생성하고 관리하는 기능 추가.<br>- **UI 개선:** 단순 테이블 형태가 아닌, 조건(국적 그룹, 서비스 레벨)에 따라 가격을 시각적으로 그룹화하여 관리할 수 있는 UI로 개선. |
| **결제 관리 (`/payments`)** | - | **모든 결제 내역 관리**<br>- 결제 목록 조회 (신청 건과 연동)<br>- 결제 상태 확인 (성공, 실패, 환불)<br>- 수동 결제 처리 및 환불 처리 기능 | **[R]** `getPayments`: 모든 결제 내역 조회.<br>**[U]** `updatePaymentStatus(id, status)`: 결제 상태 수동 업데이트.<br>**[C]** `createManualPayment`: 오프라인 결제 등 수동으로 결제 기록 생성. | - **영수증/인보이스 발급:** 각 결제 건에 대해 PDF 형식의 영수증 또는 인보이스를 생성하고 다운로드할 수 있는 기능 추가. `invoiceGenerator.js` 활용. |
| **상담/문의 관리 (`/consultations`)** | - | **고객 문의사항 관리**<br>- 웹사이트를 통해 접수된 문의 목록 조회<br>- 문의 내용 확인 및 답변 처리<br>- 처리 상태 변경 (신규, 확인 중, 답변 완료) | **[R]** `getConsultations`: 전체 문의 목록 조회.<br>**[U]** `updateConsultation(id, input)`: 문의에 대한 답변 및 상태 업데이트. | - **템플릿 답변:** 자주 묻는 질문에 대해 미리 작성된 답변 템플릿을 불러와 빠르게 답변하는 기능 추가. |
| **워크플로우 (`/workflows`)** | - | **업무 처리 절차 자동화 및 관리**<br>- 비자 신청 유형별 처리 단계 정의 (예: E-Visa: 접수 → 서류 검토 → 정부 제출 → 발급 → 고객 전달)<br>- 각 단계별 자동 알림 설정 (예: '정부 제출' 단계 변경 시 담당자에게 알림) | **[C]** `createWorkflowTemplate(input)`: 새로운 업무 절차 템플릿 생성.<br>**[R]** `getWorkflowTemplates`: 모든 템플릿 조회.<br>**[U]** `updateWorkflowTemplate(id, input)`: 템플릿 수정.<br>**[D]** `deleteWorkflowTemplate(id)`: 템플릿 삭제. | - **시각적 편집기:** 코드가 아닌, 드래그앤드롭 방식으로 각 단계를 시각적으로 연결하여 워크플로우를 설계하는 UI/UX 도입. |
| **알림 (`/notifications`)** | - | **시스템 내 주요 이벤트 알림 확인**<br>- 신규 비자 신청, 결제 완료, 신규 문의 등 관리자가 확인해야 할 알림 목록<br>- 알림 클릭 시 해당 상세 페이지로 이동<br>- 전체 읽음 처리 기능 | **[R]** `getNotifications`: 로그인된 관리자의 모든 알림 조회.<br>**[U]** `markAsRead(id)`: 특정 알림을 읽음 처리.<br>**[U]** `markAllAsRead`: 모든 알림을 읽음 처리. | - **외부 채널 연동:** 중요한 알림(예: 긴급 비자 신청) 발생 시, 이메일이나 슬랙(Slack) 등 외부 채널로 실시간 알림을 보내는 기능 추가. |
| **설정 (`/settings`)** | - | **웹사이트 전반의 기본 설정 관리**<br>- 회사 정보 (주소, 연락처, 사업자 정보) 수정<br>- 결제 연동 정보(API 키 등) 관리<br>- 이메일 템플릿 관리 (가입 환영, 신청 완료, 발급 안내 등) | **[R]** `getSystemSettings`<br>**[U]** `updateSystemSettings(input)`: Key-Value 형태로 저장된 시스템 설정값을 조회하고 수정. | - **이메일 템플릿 편집기:** 관리자가 HTML 코드 없이 텍스트와 변수(`{{userName}}` 등)를 이용해 쉽게 이메일 템플릿을 수정할 수 있는 위지윅(WYSIWYG) 에디터 도입. |

- 다국어(베트남어(기준), 한국어, 영어) 확장 고려
